# אפיון מערכת לסינון וחיפוש טקסטים לפי כללי ניקוד

## 1. תיאור כללי
מערכת לניהול מסד נתונים טקסטואלי עם יכולות חיפוש וסינון מתקדמות לפי כללי ניקוד עברי. המערכת תאפשר טעינת טקסטים, חיפוש לפי קריטריונים מרובים של ניקוד, וייצוא תוצאות לאקסל עם אפשרויות סינון נוספות.

## 2. מטרות המערכת
- ניהול מסד נתונים טקסטואלי גדול עם ניקוד עברי
- חיפוש וסינון מילים לפי כללי ניקוד מורכבים
- תמיכה בשילובי תנאים מרובים
- ייצוא תוצאות לאקסל עם מידע מפורט
- ממשק משתמש ידידותי בעברית

## 3. כללי הניקוד המזוהים

### 3.1 קטגוריות סינון ראשיות

#### א. הברות פתוחות וסגורות
- **מסתיים ב**: זיהוי הברות פתוחות לפי סיומת
  - א, ה, ה דגושה, ע
  - קמץ, צירה+י, חיריק+י
  - מלאופום, חולם
- **פתח גנובה**: ח + פתח בסוף מילה
- **קמץ המשתנה**:
  - קמץ + ה דגושה
  - קמץ + אות + שווא
  - קמץ + שתי אותיות + שווא
  - קמץ + י

#### ב. סימני ניקוד
- **מכיל/לא מכיל**:
  - קמץ (כולל חטף קמץ)
  - פתח (כולל חטף פתח)
  - צירה
  - סגול (כולל חטף סגול)
  - חיריק
  - שורוק
  - מלאופום
  - חולם
  - שווא

#### ג. כללי שווא מורכבים
- **שווא נע**:
  - תחילת מילה: אות + שווא
  - תחילת מילה: אות + דגש + שווא
  - תחילת מילה: ש + אות + שווא
- **שווא נח**:
  - אות + שווא (לא בתחילה)
  - ללא שני שוואים
- **שני שוואים**:
  - שווא + אות + שווא (באמצע)
  - שווא + שתי אותיות + שווא (לא בסוף)
  - שני שוואים בסוף מילה
- **שילובים**:
  - שווא נע + שווא נח
  - שני שווא נח
- **מקרים מיוחדים**:
  - אותיות הדומות (ללא ניקוד)

## 4. דרישות פונקציונליות

### 4.1 ניהול מסד נתונים
- **טעינת טקסטים**:
  - קבצי TXT עם קידוד UTF-8
  - קבצי DOCX
  - טקסט ישיר (copy-paste)
  - תמיכה בטקסטים מרובים
- **אינדוקס**:
  - פירוק לרמת מילה
  - שמירת ניקוד מלא
  - שמירת הקשר (מיקום במקור)
- **ניהול קטגוריות**:
  - סיווג טקסטים לקטגוריות
  - תיוג מטא-דאטה

### 4.2 מנוע חיפוש וסינון
- **חיפוש בסיסי**:
  - חיפוש מילה מדויקת
  - חיפוש עם/בלי ניקוד
  - חיפוש ביטויים
- **סינון לפי כללי ניקוד**:
  - בחירת כלל אחד או יותר
  - שילוב תנאים ב-AND/OR
  - שלילת תנאים (NOT)
- **סינון מתקדם**:
  - שילוב מספר שלבי סינון
  - סינון לפי קטגוריה
  - סינון לפי אורך מילה
- **תצוגת תוצאות**:
  - מילים שנמצאו
  - מספר מופעים
  - הקשר (משפט/פסקה)
  - מקור (קובץ/טקסט)

### 4.3 ייצוא לאקסל
- **פורמט הייצוא**:
  - עמודה א': המילה
  - עמודה ב': הניקוד המלא
  - עמודה ג': קטגוריית הברה (פתוחה/סגורה)
  - עמודה ד': סוגי ניקוד שנמצאו
  - עמודה ה': כללי שווא רלוונטיים
  - עמודה ו': מספר מופעים
  - עמודה ז': דוגמאות הקשר
  - עמודה ח': מקור
  - עמודה ט': קטגוריה
  - עמודה י': הערות
- **אפשרויות סינון באקסל**:
  - הוספת AutoFilter אוטומטית
  - טבלאות Pivot מוכנות
  - עיצוב מותאם לעברית (RTL)

### 4.4 ממשק משתמש
- **חלון ראשי**:
  - אזור טעינת טקסטים
  - פאנל כללי סינון
  - אזור תצוגת תוצאות
  - סרגל כלים
- **בניית שאילתה**:
  - בחירת כללים מרשימה
  - הוספת תנאים מותאמים
  - תצוגה מקדימה של השאילתה
- **ניהול תוצאות**:
  - מיון לפי עמודות
  - סינון מהיר
  - בחירת פריטים לייצוא

## 5. דרישות טכניות

### 5.1 טכנולוגיות
- **שפת פיתוח**: Python 3.10+
- **ממשק משתמש**: Tkinter / PyQt5 / Streamlit
- **Database**: SQLite עם תמיכה מלאה ב-UTF-8
- **ניתוח ניקוד**: ספריות Python לעיבוד טקסט עברי
- **ייצוא לאקסל**: openpyxl / xlsxwriter
- **עיבוד טקסט**: regex, unicodedata

### 5.2 ביצועים
- טיפול בעד 1 מיליון מילים
- זמן תגובה מקסימלי: 3 שניות לחיפוש
- תמיכה בעבודה מקבילית

### 5.3 אבטחה ונתונים
- גיבוי אוטומטי של מסד הנתונים
- הצפנת נתונים רגישים
- ניהול הרשאות משתמשים

## 6. מבנה נתונים

### 6.1 טבלת מילים (Words)
```sql
CREATE TABLE words (
    id INTEGER PRIMARY KEY,
    word TEXT NOT NULL,           -- המילה עם ניקוד
    word_plain TEXT NOT NULL,     -- המילה ללא ניקוד
    nikud_pattern TEXT,           -- תבנית הניקוד
    syllable_type TEXT,           -- פתוחה/סגורה
    has_shva BOOLEAN,
    shva_types TEXT,              -- JSON array של סוגי שווא
    nikud_marks TEXT,             -- JSON array של סימני ניקוד
    source_id INTEGER,
    position INTEGER,
    context TEXT,
    category_id INTEGER,
    FOREIGN KEY (source_id) REFERENCES sources(id),
    FOREIGN KEY (category_id) REFERENCES categories(id)
);
```

### 6.2 טבלת כללי ניקוד (NikudRules)
```sql
CREATE TABLE nikud_rules (
    id INTEGER PRIMARY KEY,
    category TEXT NOT NULL,       -- קטגוריה ראשית
    filter TEXT NOT NULL,         -- סוג המסנן
    result TEXT,                  -- תוצאה צפויה
    category2 TEXT,               -- קטגוריה משנית
    filter2 TEXT,                 -- מסנן משני
    category3 TEXT,
    filter3 TEXT,
    category4 TEXT,
    filter4 TEXT,
    final_result TEXT,            -- תוצאה סופית
    notes TEXT                    -- הערות
);
```

## 7. זרימת עבודה

### 7.1 תהליך טעינת טקסט
1. המשתמש טוען קובץ/טקסט
2. המערכת מפרקת לרמת מילים
3. ניתוח ניקוד לכל מילה
4. סיווג לפי כללים
5. שמירה במסד נתונים עם אינדקס

### 7.2 תהליך חיפוש
1. המשתמש בוחר כללי סינון
2. המערכת בונה שאילתת SQL
3. ביצוע החיפוש
4. עיבוד ודירוג תוצאות
5. הצגה בממשק

### 7.3 תהליך ייצוא
1. בחירת תוצאות לייצוא
2. עיבוד הנתונים לפורמט אקסל
3. הוספת עיצוב ופילטרים
4. יצירת הקובץ
5. הורדה למחשב המשתמש

## 8. שלבי פיתוח

### שלב 1: תשתית בסיסית (שבוע 1)
- הקמת פרויקט Python
- הגדרת מסד נתונים SQLite
- ממשק בסיסי עם Tkinter/Streamlit

### שלב 2: מנוע ניתוח ניקוד (שבוע 2-3)
- פיתוח אלגוריתמי זיהוי ניקוד
- מימוש כללי הסינון
- בדיקות יחידה

### שלב 3: ממשק משתמש (שבוע 4-5)
- עיצוב ומימוש UI
- טפסי חיפוש וסינון
- תצוגת תוצאות

### שלב 4: ייצוא ודוחות (שבוע 6)
- מימוש ייצוא לאקסל
- הוספת תכונות מתקדמות
- בדיקות אינטגרציה

### שלב 5: בדיקות והשלמות (שבוע 7)
- בדיקות מקיפות
- תיקוני באגים
- תיעוד משתמש

## 9. הרחבות עתידיות
- תמיכה בטעמי המקרא
- ייצוא לפורמטים נוספים (PDF, CSV)
- API לשילוב עם מערכות חיצוניות
- למידת מכונה לזיהוי דפוסים
- ממשק רב-שפתי
- גרסת מובייל

## 10. הערות מיוחדות
- יש להתחשב ביוצאי דופן בכללי השווא
- תמיכה בווריאציות ניקוד (ניקוד חלקי)
- שמירה על ביצועים גם עם מסדי נתונים גדולים
- ממשק נגיש לבעלי מוגבלויות